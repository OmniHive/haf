<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background-color: rgb(255, 255, 255);" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="828px" height="1117px" viewBox="-0.5 -0.5 828 1117" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2021-03-26T14:22:34.823Z&quot; agent=&quot;5.0 (X11)&quot; etag=&quot;2Hv_j8entlRVH0CXPMLb&quot; version=&quot;14.4.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Qf5lscOD0-_5iJms0lzf&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><path d="M 277 236 L 277 279.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 284.88 L 273.5 277.88 L 277 279.63 L 280.5 277.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="176" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 206px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Create a new CONTEXT for the application</div></div></div></foreignObject><text x="277" y="210" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Create a new CONTEXT...</text></switch></g><rect x="377" y="6" width="400" height="160" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 398px; height: 1px; padding-top: 13px; margin-left: 379px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><b>CONTEXTS(  id, name, current_block_num, processed )</b></div><div><br /></div><div><b>name</b> - human-readable id -maybe application name would be better?</div><div><b>current_block_num</b> - the block number for which the application is synced (null means not synced)</div><div><font color="#447068"><b>processed</b> - boolean flag, confirms that the application finished work with the current block (maybe not needed)</font><br /></div><div><br /></div></div></div></div></foreignObject><text x="379" y="25" fill="#000000" font-family="Helvetica" font-size="12px">CONTEXTS(  id, name, current_block_num, processed )...</text></switch></g><path d="M 277 346 L 277 366 L 277 356 L 277 369.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 374.88 L 273.5 367.88 L 277 369.63 L 280.5 367.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="286" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 316px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Register forkable tables in the new context</div></div></div></foreignObject><text x="277" y="320" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Register forkable ta...</text></switch></g><rect x="337" y="166" width="240" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 176px; margin-left: 338px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Add a new row in CONTEXTS table</div></div></div></foreignObject><text x="457" y="180" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Add a new row in CONTEXTS table</text></switch></g><rect x="347" y="286" width="370" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 296px; margin-left: 532px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">register tables by table names and the context id or name</div></div></div></foreignObject><text x="532" y="300" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">register tables by table names and the context id or name</text></switch></g><rect x="337" y="196" width="350" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 206px; margin-left: 512px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Set a human readable name for context instead of id ?</div></div></div></foreignObject><text x="512" y="210" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Set a human readable name for context instead of id ?</text></switch></g><path d="M 277 536 L 277 569.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 574.88 L 273.5 567.88 L 277 569.63 L 280.5 567.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="202" y="476" width="150" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 506px; margin-left: 203px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">next_block(context)</div></div></div></foreignObject><text x="277" y="510" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">next_block(context)</text></switch></g><rect x="367" y="466" width="260" height="110" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 258px; height: 1px; padding-top: 473px; margin-left: 369px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">function next block increments (only when processed=true) <b>current_block_num</b> for a given context, sets <b>processed</b> to false ( if block is available), returns the incremented<b> current_block_num </b>value or null in case when next block is not available</div></div></div></foreignObject><text x="369" y="485" fill="#000000" font-family="Helvetica" font-size="12px">function next block increments (only when p...</text></switch></g><path d="M 277 676 L 277 719.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 724.88 L 273.5 717.88 L 277 719.63 L 280.5 717.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 701px; margin-left: 277px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">No</div></div></div></foreignObject><text x="277" y="704" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">No</text></switch></g><path d="M 217 626 L 183.37 626" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 178.12 626 L 185.12 622.5 L 183.37 626 L 185.12 629.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 626px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><font color="#000000">Yes</font></div></div></div></foreignObject><text x="197" y="630" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">Yes</text></switch></g><path d="M 277 576 L 337 626 L 277 676 L 217 626 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 118px; height: 1px; padding-top: 626px; margin-left: 219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="center">was NULL returned ?<br /></div></div></div></div></foreignObject><text x="219" y="630" fill="#000000" font-family="Helvetica" font-size="12px">was NULL returned ?&#xa;</text></switch></g><path d="M 117 526 L 117 406 L 210.63 406" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 215.88 406 L 208.88 409.5 L 210.63 406 L 208.88 402.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="57" y="526" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 556px; margin-left: 58px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="center">wait</div></div></div></div></foreignObject><text x="117" y="560" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">wait</text></switch></g><path d="M 277 786 L 277 829.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 834.88 L 273.5 827.88 L 277 829.63 L 280.5 827.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="726" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 118px; height: 1px; padding-top: 756px; margin-left: 219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="center">update the registered tables<br /></div></div></div></div></foreignObject><text x="219" y="760" fill="#000000" font-family="Helvetica" font-size="12px">update the registere...</text></switch></g><rect x="357" y="746" width="180" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 756px; margin-left: 359px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">All oprations which are stored for registered tables by the triggers are marked with block from the context</div></div></div></foreignObject><text x="359" y="760" fill="#000000" font-family="Helvetica" font-size="12px">All oprations which are stored...</text></switch></g><rect x="317" y="216" width="215" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 213px; height: 1px; padding-top: 226px; margin-left: 318px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">context  name is unique</div></div></div></foreignObject><text x="425" y="230" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">context  name is unique</text></switch></g><rect x="354.5" y="306" width="385" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 383px; height: 1px; padding-top: 313px; margin-left: 357px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "> A table can be registered only for one context because they may be synced only for a given block, no need to pass a context for the triggers -&gt; trigger will find it, hmm maybe it is better to pass the context to trigger during registration - no need for query inside trigger body</div></div></div></foreignObject><text x="357" y="325" fill="#000000" font-family="Helvetica" font-size="12px">A table can be registered only for one context because they may...</text></switch></g><rect x="387" y="606" width="330" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 328px; height: 1px; padding-top: 613px; margin-left: 389px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="left"><font color="#FF0000">Problem with transactions</font></div><font color="#FF0000">next_block and updates the tables should be parts of the same transaction, otherwise, problems with updating tables will not rollback the context's current_block_num<br /></font></div></div></div></foreignObject><text x="389" y="625" fill="#000000" font-family="Helvetica" font-size="12px">Problem with transactionsnext_block and updates the tab...</text></switch></g><path d="M 277 886 L 277 939.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 944.88 L 273.5 937.88 L 277 939.63 L 280.5 937.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="157" y="836" width="240" height="50" rx="7.5" ry="7.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 238px; height: 1px; padding-top: 861px; margin-left: 159px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">confirm_finished( context, block_num) </div></div></div></foreignObject><text x="159" y="865" fill="#447068" font-family="Helvetica" font-size="12px">confirm_finished( context, block_num) </text></switch></g><rect x="417" y="836" width="170" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 168px; height: 1px; padding-top: 846px; margin-left: 419px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>block_num</b> passed only for check correctness, context would be enaugh to set the <b>processed</b> flag</div></div></div></foreignObject><text x="419" y="850" fill="#447068" font-family="Helvetica" font-size="12px">block_num passed only for ch...</text></switch></g><rect x="597" y="706" width="230" height="180" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 228px; height: 1px; padding-top: 713px; margin-left: 599px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">When something goes wrong here then <b>current_block</b> won't be marked as <b>processed</b> and the application will beck to the same block ( next_block once again will return it ) </div></div></div></foreignObject><text x="599" y="725" fill="#447068" font-family="Helvetica" font-size="12px">When something goes wrong here then cu...</text></switch></g><rect x="7" y="16" width="320" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 26px; margin-left: 8px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 22px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Synchronizing application's tables</div></div></div></foreignObject><text x="167" y="33" fill="#000000" font-family="Helvetica" font-size="22px" text-anchor="middle" font-weight="bold">Synchronizing application's t...</text></switch></g><rect x="47" y="76" width="220" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 218px; height: 1px; padding-top: 83px; margin-left: 49px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">It allows to synchronize and back from forks many different tables on different block_num levels</div></div></div></foreignObject><text x="49" y="95" fill="#000000" font-family="Helvetica" font-size="12px">It allows to synchronize and back fr...</text></switch></g><rect x="337" y="246" width="252" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 250px; height: 1px; padding-top: 256px; margin-left: 338px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">The context allow to group forkable tables by different block_num levels</div></div></div></foreignObject><text x="463" y="260" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">The context allow to group forkable tables...</text></switch></g><path d="M 277 436 L 277 469.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 474.88 L 273.5 467.88 L 277 469.63 L 280.5 467.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="376" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 406px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#000000">BEGIN TRANSACTION</font></div></div></div></foreignObject><text x="277" y="410" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">BEGIN TRANSACTION</text></switch></g><path d="M 117 596 L 117 592.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 117 587.12 L 120.5 594.12 L 117 592.37 L 113.5 594.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="57" y="596" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 626px; margin-left: 58px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">COMMIT</div></div></div></foreignObject><text x="117" y="630" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">COMMIT</text></switch></g><path d="M 217 1001 L 37 1001 L 37 486 L 190.63 486" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 195.88 486 L 188.88 489.5 L 190.63 486 L 188.88 482.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 753px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><font color="#000000">No</font></div></div></div></foreignObject><text x="37" y="757" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">No</text></switch></g><path d="M 277 1056 L 277 1086 L 208.37 1086" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 203.12 1086 L 210.12 1082.5 L 208.37 1086 L 210.12 1089.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1086px; margin-left: 254px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><font color="#000000">Yes</font></div></div></div></foreignObject><text x="254" y="1090" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">Yes</text></switch></g><path d="M 277 946 L 337 1001 L 277 1056 L 217 1001 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1001px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#000000">is it enaugh blocks processed to commit ?<br /></font></div></div></div></foreignObject><text x="277" y="1005" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">is it enaugh blocks...</text></switch></g><path d="M 82 1086 L 7 1086 L 7 391 L 210.63 391" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 215.88 391 L 208.88 394.5 L 210.63 391 L 208.88 387.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="82" y="1056" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1086px; margin-left: 83px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">COMMIT</div></div></div></foreignObject><text x="142" y="1090" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">COMMIT</text></switch></g><rect x="342" y="416" width="230" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 228px; height: 1px; padding-top: 426px; margin-left: 344px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Needs to start transaction here to allow to proccess more than one block in one transaction</div></div></div></foreignObject><text x="344" y="430" fill="#000000" font-family="Helvetica" font-size="12px">Needs to start transaction here to all...</text></switch></g><rect x="427" y="906" width="240" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 238px; height: 1px; padding-top: 916px; margin-left: 429px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">flag processed and confirm_finished look like unneeded, it is enaugh to make the operations in a transaction</div></div></div></foreignObject><text x="429" y="920" fill="#447068" font-family="Helvetica" font-size="12px" font-weight="bold">flag processed and confirm_finished look...</text></switch></g><rect x="12" y="686" width="290" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 696px; margin-left: 14px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><font color="#FF0000"><b>CANNOT use PQ library inside triggers !</b><br /></font></div><div><font color="#FF0000">Pq makes a connection and all operations executed within this connection are not included in the parent transaction</font><br /><font color="#FF0000"></font></div></div></div></div></foreignObject><text x="14" y="700" fill="#447068" font-family="Helvetica" font-size="12px">CANNOT use PQ library inside triggers !...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>