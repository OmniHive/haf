<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background-color: rgb(255, 255, 255);" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="828px" height="1117px" viewBox="-0.5 -0.5 828 1117" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2021-03-26T06:36:08.915Z&quot; agent=&quot;5.0 (X11)&quot; etag=&quot;M8OjZFGoR8EozNzGNtcw&quot; version=&quot;14.4.2&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Qf5lscOD0-_5iJms0lzf&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><path d="M 277 236 L 277 279.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 284.88 L 273.5 277.88 L 277 279.63 L 280.5 277.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="176" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 206px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Create a new CONTEXT for the application</div></div></div></foreignObject><text x="277" y="210" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Create a new CONTEXT...</text></switch></g><rect x="377" y="6" width="400" height="160" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 398px; height: 1px; padding-top: 13px; margin-left: 379px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><b>CONTEXTS(  id, name, current_block_num, processed )</b></div><div><br /></div><div><b>name</b> - human-readable id -maybe application name would be better?</div><div><b>current_block_num</b> - the block number for which the application is synced (null means not synced)</div><div><b>processed</b> - boolean flag, confirms that the application finished work with the current block<br /></div><div><br /></div></div></div></div></foreignObject><text x="379" y="25" fill="#000000" font-family="Helvetica" font-size="12px">CONTEXTS(  id, name, current_block_num, processed )...</text></switch></g><path d="M 277 346 L 277 366 L 277 356 L 277 369.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 374.88 L 273.5 367.88 L 277 369.63 L 280.5 367.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="286" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 316px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Register forkable tables in the new context</div></div></div></foreignObject><text x="277" y="320" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Register forkable ta...</text></switch></g><rect x="337" y="166" width="240" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 238px; height: 1px; padding-top: 176px; margin-left: 338px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Add a new row in CONTEXTS table</div></div></div></foreignObject><text x="457" y="180" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Add a new row in CONTEXTS table</text></switch></g><rect x="347" y="286" width="370" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 296px; margin-left: 532px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">register tables by table names and the context id or name</div></div></div></foreignObject><text x="532" y="300" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">register tables by table names and the context id or name</text></switch></g><rect x="337" y="196" width="350" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 206px; margin-left: 512px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">Set a human readable name for context instead of id ?</div></div></div></foreignObject><text x="512" y="210" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Set a human readable name for context instead of id ?</text></switch></g><path d="M 277 536 L 277 569.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 574.88 L 273.5 567.88 L 277 569.63 L 280.5 567.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="202" y="476" width="150" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 506px; margin-left: 203px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">next_block(context)</div></div></div></foreignObject><text x="277" y="510" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">next_block(context)</text></switch></g><rect x="367" y="466" width="260" height="110" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 258px; height: 1px; padding-top: 473px; margin-left: 369px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">function next block increments (only when processed=true) <b>current_block_num</b> for a given context, sets <b>processed</b> to false ( if block is available), returns the incremented<b> current_block_num </b>value or null in case when next block is not available</div></div></div></foreignObject><text x="369" y="485" fill="#000000" font-family="Helvetica" font-size="12px">function next block increments (only when p...</text></switch></g><path d="M 277 676 L 277 719.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 724.88 L 273.5 717.88 L 277 719.63 L 280.5 717.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 701px; margin-left: 277px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">No</div></div></div></foreignObject><text x="277" y="704" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">No</text></switch></g><path d="M 217 626 L 183.37 626" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 178.12 626 L 185.12 622.5 L 183.37 626 L 185.12 629.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 626px; margin-left: 197px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><font color="#000000">Yes</font></div></div></div></foreignObject><text x="197" y="630" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">Yes</text></switch></g><path d="M 277 576 L 337 626 L 277 676 L 217 626 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 118px; height: 1px; padding-top: 626px; margin-left: 219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="center">was NULL returned ?<br /></div></div></div></div></foreignObject><text x="219" y="630" fill="#000000" font-family="Helvetica" font-size="12px">was NULL returned ?&#xa;</text></switch></g><path d="M 117 526 L 117 406 L 210.63 406" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 215.88 406 L 208.88 409.5 L 210.63 406 L 208.88 402.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="57" y="526" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 556px; margin-left: 58px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="center">wait</div></div></div></div></foreignObject><text x="117" y="560" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">wait</text></switch></g><path d="M 277 786 L 277 829.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 834.88 L 273.5 827.88 L 277 829.63 L 280.5 827.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="726" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 118px; height: 1px; padding-top: 756px; margin-left: 219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="center">update the registered tables<br /></div></div></div></div></foreignObject><text x="219" y="760" fill="#000000" font-family="Helvetica" font-size="12px">update the registere...</text></switch></g><rect x="357" y="746" width="180" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 756px; margin-left: 359px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">All oprations which are stored for registered tables by the triggers are marked with block from the context</div></div></div></foreignObject><text x="359" y="760" fill="#000000" font-family="Helvetica" font-size="12px">All oprations which are stored...</text></switch></g><rect x="317" y="216" width="215" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 213px; height: 1px; padding-top: 226px; margin-left: 318px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">context  name is unique</div></div></div></foreignObject><text x="425" y="230" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">context  name is unique</text></switch></g><rect x="354.5" y="306" width="385" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 383px; height: 1px; padding-top: 313px; margin-left: 357px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "> A table can be registered only for one context because they may be synced only for a given block, no need to pass a context for the triggers -&gt; trigger will find it, hmm maybe it is better to pass the context to trigger during registration - no need for query inside trigger body</div></div></div></foreignObject><text x="357" y="325" fill="#000000" font-family="Helvetica" font-size="12px">A table can be registered only for one context because they may...</text></switch></g><rect x="387" y="606" width="330" height="90" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 328px; height: 1px; padding-top: 613px; margin-left: 389px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div align="left"><font color="#FF0000">Problem with transactions</font></div><font color="#FF0000">next_block and updates the tables should be parts of the same transaction, otherwise, problems with updating tables will not rollback the context's current_block_num<br /></font></div></div></div></foreignObject><text x="389" y="625" fill="#000000" font-family="Helvetica" font-size="12px">Problem with transactionsnext_block and updates the tab...</text></switch></g><path d="M 277 886 L 277 939.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 944.88 L 273.5 937.88 L 277 939.63 L 280.5 937.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="157" y="836" width="240" height="50" rx="7.5" ry="7.5" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 238px; height: 1px; padding-top: 861px; margin-left: 159px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">confirm_finished( context, block_num) </div></div></div></foreignObject><text x="159" y="865" fill="#447068" font-family="Helvetica" font-size="12px">confirm_finished( context, block_num) </text></switch></g><rect x="417" y="836" width="170" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 168px; height: 1px; padding-top: 846px; margin-left: 419px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b>block_num</b> passed only for check correctness, context would be enaugh to set the <b>processed</b> flag</div></div></div></foreignObject><text x="419" y="850" fill="#447068" font-family="Helvetica" font-size="12px">block_num passed only for ch...</text></switch></g><rect x="597" y="706" width="230" height="180" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 228px; height: 1px; padding-top: 713px; margin-left: 599px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">When something goes wrong here then <b>current_block</b> won't be marked as <b>processed</b> and the application will beck to the same block ( next_block once again will return it ) </div></div></div></foreignObject><text x="599" y="725" fill="#447068" font-family="Helvetica" font-size="12px">When something goes wrong here then cu...</text></switch></g><rect x="7" y="16" width="320" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 26px; margin-left: 8px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 22px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Synchronizing application's tables</div></div></div></foreignObject><text x="167" y="33" fill="#000000" font-family="Helvetica" font-size="22px" text-anchor="middle" font-weight="bold">Synchronizing application's t...</text></switch></g><rect x="47" y="76" width="220" height="80" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 218px; height: 1px; padding-top: 83px; margin-left: 49px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">It allows to synchronize and back from forks many different tables on different block_num levels</div></div></div></foreignObject><text x="49" y="95" fill="#000000" font-family="Helvetica" font-size="12px">It allows to synchronize and back fr...</text></switch></g><rect x="337" y="246" width="252" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 250px; height: 1px; padding-top: 256px; margin-left: 338px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">The context allow to group forkable tables by different block_num levels</div></div></div></foreignObject><text x="463" y="260" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">The context allow to group forkable tables...</text></switch></g><path d="M 277 436 L 277 469.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 277 474.88 L 273.5 467.88 L 277 469.63 L 280.5 467.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="217" y="376" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 406px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#000000">BEGIN TRANSACTION</font></div></div></div></foreignObject><text x="277" y="410" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">BEGIN TRANSACTION</text></switch></g><path d="M 117 596 L 117 592.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 117 587.12 L 120.5 594.12 L 117 592.37 L 113.5 594.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="57" y="596" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 626px; margin-left: 58px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">COMMIT</div></div></div></foreignObject><text x="117" y="630" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">COMMIT</text></switch></g><path d="M 217 1001 L 37 1001 L 37 486 L 190.63 486" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 195.88 486 L 188.88 489.5 L 190.63 486 L 188.88 482.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 753px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><font color="#000000">No</font></div></div></div></foreignObject><text x="37" y="757" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">No</text></switch></g><path d="M 277 1056 L 277 1086 L 208.37 1086" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 203.12 1086 L 210.12 1082.5 L 208.37 1086 L 210.12 1089.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1086px; margin-left: 254px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; "><font color="#000000">Yes</font></div></div></div></foreignObject><text x="254" y="1090" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">Yes</text></switch></g><path d="M 277 946 L 337 1001 L 277 1056 L 217 1001 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1001px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #FF0000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#000000">is it enaugh blocks processed to commit ?<br /></font></div></div></div></foreignObject><text x="277" y="1005" fill="#FF0000" font-family="Helvetica" font-size="12px" text-anchor="middle">is it enaugh blocks...</text></switch></g><path d="M 82 1086 L 7 1086 L 7 391 L 210.63 391" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 215.88 391 L 208.88 394.5 L 210.63 391 L 208.88 387.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="82" y="1056" width="120" height="60" rx="9" ry="9" fill="#ffffff" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1086px; margin-left: 83px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">COMMIT</div></div></div></foreignObject><text x="142" y="1090" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">COMMIT</text></switch></g><rect x="342" y="416" width="230" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 228px; height: 1px; padding-top: 426px; margin-left: 344px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Needs to start transaction here to allow to proccess more than one block in one transaction</div></div></div></foreignObject><text x="344" y="430" fill="#000000" font-family="Helvetica" font-size="12px">Needs to start transaction here to all...</text></switch></g><rect x="427" y="906" width="240" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 238px; height: 1px; padding-top: 916px; margin-left: 429px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">flag processed and confirm_finished look like unneeded, it is enaugh to make the operations in a transaction</div></div></div></foreignObject><text x="429" y="920" fill="#447068" font-family="Helvetica" font-size="12px" font-weight="bold">flag processed and confirm_finished look...</text></switch></g><rect x="12" y="686" width="290" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 696px; margin-left: 14px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #447068; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div><font color="#FF0000"><b>CANNOT use PQ library inside triggers !</b><br /></font></div><div><font color="#FF0000">Pq makes a connection and all operations executed within this connection are not included in the parent transaction</font><br /><font color="#FF0000"></font></div></div></div></div></foreignObject><text x="14" y="700" fill="#447068" font-family="Helvetica" font-size="12px">CANNOT use PQ library inside triggers !...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>